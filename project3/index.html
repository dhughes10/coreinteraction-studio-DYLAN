<html>
<head>
  <link rel="stylesheet" href="main.css">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
</head>

<body>
  <div class="username-form">
    <label>Enter a username to begin</label>
    <input type="text" class="username-input">
    <input class="submit-button" type="submit" value="submit">
  </div>

  <div class="message-container"></div>
  <iframe frameBorder="0" src=""></iframe>

</body>
<script src="mousetrap.min.js"></script>
 <script src="https://code.jquery.com/jquery-2.1.4.js"></script>
    <script src="https://s3.amazonaws.com/ci-sp-2016/ci-chat.js"></script>
<script id="jsbin-javascript">
var username;

// When the user clicks the submit button, we want to save the 
// username they entered, hide the form, and show the color input
$('.submit-button').click(function (e) {
  username = $('.username-input').val();

  $('.username-form').addClass('is-hidden');
  $('.color-input').removeClass('is-hidden');
});

// Actually handle user input on our chat options
// This is where we're tying particular values to 
// colors in messages we send.
// var code = e.keyCode || e.which;
//  if(code == 13) { 
//  	sendMessage(0);
//  }
Mousetrap.bind(['a', 'e', 'j', '1'], 
	function() { sendMessage(0); });
Mousetrap.bind(['q', 'd', 'c', '5'], 
	function() { sendMessage(1); });
Mousetrap.bind(['z', 'c','3'], 
	function() { sendMessage(2); });
Mousetrap.bind(['w', 'r', '2'], 
	function() { sendMessage(3); });
Mousetrap.bind(['s', 'f', '8'], 
	function() { sendMessage(4); });
Mousetrap.bind(['x', 'v', '4'], 
	function() { sendMessage(5); });
Mousetrap.bind(['p', 't', '7'], 
	function() { sendMessage(6); });
Mousetrap.bind(['l', 'g', '0'], 
	function() { sendMessage(7); });
Mousetrap.bind([',', 'b', '6'], 
	function() { sendMessage(8); });
Mousetrap.bind(['o', 'y', '9'], 
	function() { sendMessage(9); });
Mousetrap.bind(['k', 'h', '['], 
	function() { sendMessage(10); });
Mousetrap.bind(['m', 'n', ','], 
	function() { sendMessage(11); });
Mousetrap.bind(['i', 'u', ']'], 
	function() { sendMessage(12); });


// This is where the magic happens!!!
// We use the Chat object's `sendMessage` function
// to actually send the message
function sendMessage(value) {
  Chat.sendMessage({
    sender: username,
    type: 'color',
    value: value
  });
}

// This map of color values makes it easy
// for us to interpret the messages we receive
var colorValues = {
  0: 'blue',
  1: 'red',
  2: 'purple',
  3: 'yellow',
  4: 'cyan',
  5: 'turquoise',
  6: 'green',
  7: 'navy',
  8: 'fuchsia',
  9: 'tan',
  10: 'ochre',
  11: 'beige',
  12: 'pink'
};

// And here's where we actually handle incoming messages
// For each message we get, we create a new element, label
// it with the message sender's name, and assign classes
// based on its sender and value
Chat.onMessage(function (data) {
  // Create the message element
  var divsize = ((Math.random()*100) + 50);
  var message = $('<div></div>');
  $(message).addClass('message');

var posx = (Math.random() * ($(document).width() - divsize));
var posy = (Math.random() * ($(document).height() - divsize));

$(message).css({
    'position':'absolute',
    'left':posx+'px',
    'top':posy+'px',
    'display':'none'
}).appendTo( 'body' ).fadeIn(80);

$(message).delay( 10000 ).fadeOut(2000);


  // Here's where we assign the color class. We use the
  // message's value to pull a color from our map of 
  // colors above
  $(message).addClass(colorValues[data.value]);

  // If the message is from the current user, give it a
  // special class
  if (data.sender == username) {
    $(message).addClass('from-current-user');
  }

  // Create the label element and set its html
  var messageLabel = $('<div></div>');
  $(messageLabel).html(data.sender);

  // Append label to the message
  $(message).append(messageLabel);

  // Append message to the container on the page
  $('.message-container').append(message);
});

// This is where we handle changes in active user count.
// We're going to lighten the background based on the number
// of users on the page
Chat.onUserCountChange(function (currentCount) {
  // We'll say that maximum lightness happens at 20 users,
  // so we'll treat all counts greater than 20 the same as 20
  if (currentCount > 20) {
    currentCount = 20;
  }

  // How close we are to twenty users determines the lightness.
  // It's a percentage so we multiply by 100.
  var lightness = Math.round((currentCount / 20) * 100);

  // Actually set the background color. HSL is often the easiest
  // color format to use when modifying color dynamically
  $('body').css({
    backgroundColor: 'hsl(0,0%,' + lightness + '%)'
  });
  var sites = [
	'http://fontsinuse.com/typefaces/57/graphik',
	'http://www.w3schools.com/jquery/eff_fadeout.asp',
	];

	var changeSite = function() {
		var url = sites[Math.floor(Math.random() * sites.length)];
		$('iframe').attr('src',url);
}
	window.setInterval(changeSite, 50000);
		 });

</script>

</html>




